<div class="container mt-4">
  <h2 class="mb-4">Lista de Usuários</h2>

  <!-- Filtros -->
  <form [formGroup]="formulario" class="row g-3 mb-3">
    <div class="col-md-4">
      <app-btn-input label="Pesquisar por nome" [control]="formulario.get('nome')"></app-btn-input>
    </div>
    <div class="col-md-4">
      <app-btp-dropdown label="Tipo Usuário" [control]="formulario.get('tipoUsuario')"
        [options]="_listaTipoUsuario"></app-btp-dropdown>
    </div>
    <div class="col-md-4">
      <app-btp-dropdown label="Status" [control]="formulario.get('status')" [options]="_listaStatus"></app-btp-dropdown>
    </div>
    <div class="col-12">
      <button class="btn btn-primary w-100" (click)="setFluxoPaginacao()">Filtrar</button>
    </div>
  </form>

  <!-- Tabela de Usuários -->
  <div class="table-responsive">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>ID</th>
          <th>Nome</th>
          <th>Email</th>
          <th>Tipo de Usuário</th>
          <th>Status</th>
          <th class="centralizar">Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let usuario of listaPaginada; let i = index">
          <td>{{ usuario.id }}</td>
          <td>{{ usuario.nome }}</td>
          <td>{{ usuario.email }}</td>
          <td>{{ usuario.tipoUsuario | mapValueToLabel:'usuario' }}</td>
          <td>{{ usuario.status | mapValueToLabel:'status' }}</td>
          <td>
            <div class="d-flex justify-content-center flex-wrap gap-2">
              <button class="btn btn-sm btn-warning" (click)="editar(usuario)">Atualizar</button>
              <button class="btn btn-sm btn-info" (click)="visualizar(usuario)">Visualizar</button>
              <button class="btn btn-sm btn-danger" (click)="deletar(usuario)">Deletar</button>
            </div>
          </td>
        </tr>
        <tr *ngIf="listaPaginada.length === 0">
          <td colspan="6" class="text-center">Nenhum usuário encontrado.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <app-paginacao [totalPaginas]="totalPaginas" [paginaAtual]="paginaAtual" [paginas]="paginas"
    (mudarPagina)="botaoAvancaOuRetornaPagina($event)"></app-paginacao>
</div>

<div class="mt-3 mb-1 text-end">
  <button class="btn btn-secondary me-2" (click)="voltar()">Voltar</button>
  <button *ngIf="_habilitarBotaoPersistir" class="btn btn-primary me-2" (click)="criarUsuario()">Criar Usuário</button>
</div>

<app-notificador-mensagens></app-notificador-mensagens>